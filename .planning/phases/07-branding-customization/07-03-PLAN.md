---
phase: 07-branding-customization
plan: 03
type: execute
---

<objective>
Customize share pages (estimate, invoice, damage assessment) with tenant branding.

Purpose: Public share pages should display tenant's logo and branding, not generic styling.
Output: Share pages show tenant logo, business name, contact info, and apply tier-appropriate styling.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-branding-customization/07-02-SUMMARY.md

**Share pages:**
- /share/estimate/[token] - Public estimate view
- /share/invoice/[token] - Public invoice view
- /share/assessment/[token] - Public damage assessment view

**Branding by tier:**
- All tiers: Show tenant logo and business name
- Business+: Apply primary color theming to share pages

**Data source:**
- Share token API already returns tenant info
- Need to include logo_url, primary_color, business details in response

@app/share/estimate/[token]/page.tsx
@app/share/invoice/[token]/page.tsx
@app/share/assessment/[token]/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update share APIs to include tenant branding</name>
  <files>
app/api/autow/estimate/share/route.ts,
app/api/autow/invoice/share/route.ts,
app/api/autow/damage-assessment/share/route.ts
  </files>
  <action>
Update share/view APIs to include tenant branding data:

For each share route, modify the response to include:
```typescript
{
  // existing data...
  tenant: {
    businessName: tenant.business_name,
    logoUrl: tenant.logo_url,
    primaryColor: tenant.primary_color,
    email: tenant.email,
    phone: tenant.phone,
    address: tenant.address,
    postcode: tenant.postcode,
    bankName: tenant.bank_name,
    bankAccountName: tenant.bank_account_name,
    bankSortCode: tenant.bank_sort_code,
    bankAccountNumber: tenant.bank_account_number,
  }
}
```

Query tenant table to get these fields when generating share response.
These pages are public (no auth required) but data is scoped to the share token's document.
  </action>
  <verify>Share API responses include tenant object with branding data</verify>
  <done>
- Share APIs return tenant branding info
- Logo URL, colors, and contact details included
  </done>
</task>

<task type="auto">
  <name>Task 2: Update share pages with tenant branding</name>
  <files>
app/share/estimate/[token]/page.tsx,
app/share/invoice/[token]/page.tsx,
app/share/assessment/[token]/page.tsx
  </files>
  <action>
Update all share pages to display tenant branding:

1. **Header Section:**
   - Show tenant logo (if exists) instead of hardcoded logo
   - Display business name prominently
   - Show contact details (email, phone)

2. **Footer/Bank Details (invoices/estimates):**
   - Display bank details for payment
   - Show business address

3. **Styling:**
   - Apply tenant's primaryColor to accents
   - Use CSS custom properties pattern
   - Fallback to default blue if no custom color

4. **Layout:**
   - Clean, professional design
   - Mobile-responsive
   - Print-friendly (for PDF generation later)

Pattern for each page:
```typescript
const tenant = data.tenant;
// Apply CSS variables
document.documentElement.style.setProperty('--primary-color', tenant.primaryColor || '#3B82F6');
```
  </action>
  <verify>Share pages display tenant logo and apply their primary color</verify>
  <done>
- Share pages show tenant logo
- Business name and contact visible
- Primary color applied to styling
  </done>
</task>

<task type="auto">
  <name>Task 3: Final cleanup and verification</name>
  <files>
.planning/STATE.md,
.planning/ROADMAP.md
  </files>
  <action>
1. Run full build verification:
   - `npm run build` must pass
   - Test share pages render correctly

2. Update documentation:
   - Update STATE.md to mark Phase 7 complete
   - Update ROADMAP.md progress table
   - Set progress to 87% (7 of 8 phases)

3. Create 07-03-SUMMARY.md with:
   - All branding features implemented
   - Tier-gated customization working
   - Share pages branded

4. Commit all Phase 7 changes
  </action>
  <verify>Build passes, share pages display correct branding</verify>
  <done>
- Phase 7 complete
- All branding features working
- Documentation updated
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Share APIs return tenant branding data
- [ ] Share pages display tenant logo
- [ ] Primary color applied to share pages
- [ ] Bank details visible on invoices
- [ ] Phase 7 marked complete in STATE.md
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Share pages fully branded
- Phase 7 complete
</success_criteria>

<output>
After completion, create `.planning/phases/07-branding-customization/07-03-SUMMARY.md`

Update STATE.md:
- Phase: 8 of 8 (Landing Page & Polish) â€” READY
- Progress: 87%
- Note: Phase 7 complete

Update ROADMAP.md:
- Phase 7 status: Complete
</output>
